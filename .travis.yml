language: python
sudo: required
cache: pip
env:
  MIN_PYLINT_SCORE: 8
os:
  - linux
python:
  - "3.6"
script:
  - pip install pipenv
  - pipenv install --dev
  - pipenv run nose2 --with-coverage
  - ./tests/lint.sh
  - ./tests/docstyle.sh
after_success:
  - coveralls
  - if [ -z "$TRAVIS_TAG" ]; then
      echo "Not a tagged commit; skipping deploy.";
    else
      docker build ./ -t arxiv/submission-ui:${TRAVIS_TAG};
      echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin;
      docker push arxiv/submission-ui:${TRAVIS_TAG});
    fi
